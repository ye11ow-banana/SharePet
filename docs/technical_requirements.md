# 1. Цель проекта

Цель проекта — разработать backend сайта знакомств для животных (далее Бэк). Пользователь сможет найти пару для своих питомцев и создать крепкую семью. После чего потомство делится между родителями.


# 2. Описание Бэка

Бэк состоит из следующих основных функциональных блоков:

1. Регистрация, аутентификация и авторизация
2. Функционал пользователя
3. Функционал администратора
4. Блог


## 2.1. Типы пользователей

Бэк предусматривает четыре типа пользователей: пользователь,  администратор, анонимный пользователь и руководство.

Пользователь — это аккаунт, который имеет право на полное взаемодействие с контентом, который предусмотренный [пунктом №2.4.](#24-функционал-пользователя)

Администратор — это аккаунт персонала, с расширенными правами, которые предусмотренны [пунктом №2.5.](#25-функционал-администратора)

Анонимный пользователь имеет права только на чтение блога.

Руководство — это аккаунт с найбольшими правами. Этот аккаунт имеет доступ к админке проекта, а следовательно к базе данных. Также этот аккаунт может создавать одноразовые ссылки для регистрации администраторов.


## 2.2. Регистрация 

Регистрация пользователей осуществляется с помощью трех обязательных и трех необязательных полей:

* Аватарка
* Имя
* Фамилия
* username — обязательное поле
* email — обязательное поле
* пароль — обязательное поле

После чего на почту приходит сообщение с кодом, который пользователь должен ввести в поле “code”, чтобы завершить регистрацию.

Или регистрация с помощью социальных сетей. Возможные соц сети:

* Instagram
* Facebook
* Google

Регистрация администраторов осуществляется руководством с помощью создания одноразовой ссылки, по которой переходит будущий администратор. Он вводит четыре обязательных поля:

* имя — обязательное поле
* фамилия — обязательное поле
* email — обязательное поле
* пароль — обязательное поле

После чего на почту приходит сообщение с кодом, который администратор должен ввести в поле “code”, чтобы завершить регистрацию.

Анонимный пользователь не регистрируется.
Аккаунты руководства создаются при настройке сервера.


## 2.3. Аутентификация

Аутентификация пользователей осуществляется с помощью email/username и пароля.
Аутентификация администраторов осуществляется с помощью email и пароля.
Аутентификации анонимных пользователей нет.
Аутентификация руководства осуществляется с помощью username и пароля.


## 2.4. Функционал пользователя

Пользователь после аутентификации получает доступ к своему пользовательскому функционалу. Этот функционал состоит из следующих блоков:

1. [Редактирование данных профиля](#241-редактирование-данных-профиля)
2. [Изменение настроек](#242-изменение-настроек)
3. [Добавление животных к аккаунту](#243-добавление-животных-к-аккаунту)
4. [Нахождения пары (доступно только с галочкой “проверено”)](#244-нахождение-пары)
5. [Чат с хозяином понравившегося животного (после взаимных лайков)](#245-чат-с-хозяином-понравившегося-животного)
6. [Расчет и безопасная сделка (с согласия двух сторон)](#246-расчет-и-безопасная-сделка)
7. [Заведение и редактирование контента блога](#247-заведение-и-редактирование-контента-блога)
8. [Взаимодействие с блогами](#248-взаимодействие-с-блогами)


### 2.4.1. Редактирование данных профиля

В этом разделе у пользователя есть возможность редактирования данных своего профиля — аватарки, имени, фамилии, username.

Должна быть возможность сменить пароль и/или email, подтвердив свой старый пароль и/или новый email соответственно.

Уведомление об этом приходит на почту, которая была до изменений.


### 2.4.2. Изменение настроек

В этом разделе у пользователя должна быть возможность изменить язык и настроить уведомления.

Предусматривается три языка:

* украинский
* английский
* русский

Настройки уведомлений будут типа “вкл/выкл”. По умолчанию все включены.

Уведомления на почту о:

* успешной регистрации
* аутентификации и авторизации
* изменении профиля
* изменении настроек
* лайке комментария под статьей
* ответе на комментарий под статьей
* лайке статьи пользователя
* новом комментарии под статьей пользователя
* лайке животного пользователя
* новом сообщении
* начале сделки
* истечении времени на беременность
* успешной/неуспешной сделке
* пополнении счета

Настройка статуса будет в виде переключателя.

Стутасы:
* В активном поиске
* Одному/одной и так нормально


### 2.4.3. Добавление животных к аккаунту

В этом разделе у пользователя должна быть возможность добавить n-ное количество животных к аккаунту.

Добавление происходит по следующим полям:

* аватарка животного — обязательное поле
* кличка — обязательное поле
* вид — обязательное поле
* порода — обязательное поле
* пол — обязательное поле
* возраст — обязательное поле

После добавления администратор проверит животное. В случае успеха добавит галочку “проверено”. После проверки пользователь может изменить статус животного на:

* В активном поиске
* Одному/одной и так нормально

По умолчанию “Одному/одной и так нормально”.


### 2.4.4. Нахождение пары

В этом разделе пользователю рекомендуют животных со статусом “в активном поиске” породы, вида и пола подходящих под добавленных ранее в аккаунт. Должны быть фильтры по:

* возрасту
* виду
* породе

Пользователь может лайкнуть животное, которое ему подходит. Хозяин этого животного получит уведомление и сможет лайкнуть в ответ или отклонить.


### 2.4.5. Чат с хозяином понравившегося животного

Если два пользователя лайкнут животных друг друга, у них появится возможность общаться в чате. В чате нельзя изменять/удалять сообщения, но можно прикреплять файлы. После оговора деталей владельцы чата смогут перейти к расчету и безопасной сделке.


### 2.4.6. Расчет и безопасная сделка

Пользователи ставят время, когда будет возможна беременность. Хозяин(ка) животного женского пола вносит в сделку сумму за 3 детенышей. После чего сделка начинается и статусы животных переходят в “одному/одной и так нормально”.

Животные встречаются. Через оговоренное время, когда самка должна будет стать беременной, хозяин(ка) животного женского пола либо отпускает деньги самцу, либо, если беременности нет, предоставляет доказательство ее отсутствия. После чего хозяин(ка) самца отпускает деньги обратно самке.

В случае споров, вызывается администратор.

Сделка завершается.


### 2.4.7. Заведение и редактирование контента блога

В этом разделе пользователь может написать статью. В статье он может вставить картинку или прикрепить файл. В любой момент может изменить контент статьи. Также должна быть возможность опубликовать статью или снять с публикации (добавить в черновик).

### 2.4.8. Взаимодействие с блогами

В этом разделе у пользователя должна быть возможность читать, лайкать статью, комментировать ее, отвечать на комментарии.

Также должна быть возможность поиска статьи по:

* названию
* содержимому
* дате
* комментариям


## 2.5. Функционал администратора

Администратор после аутентификации получает доступ к функционалу администратора. Этот функционал состоит из следующих блоков:

1. [Бан статей](#251-бан-статей)
2. [Бан пользователей](#252-бан-пользователей)
3. [Просмотр чата при жалобе одного из участников](#253-просмотр-чата-при-жалобе-одного-из-участников)
4. [Вынесение решения при спорах в сделке](#254-вынесение-решения-при-спорах-в-сделке)
5. [Проверка нового животного](#255-проверка-нового-животного)


### 2.5.1. Бан статей

У администратора есть возможность забанить статью, если она нарушает правила пользования. Забаненная статья удалится через трое суток. За это время пользователь может оспорить решение с помощью другого администратора.


### 2.5.2. Бан пользователей

У администратора есть возможность забанить пользователя за нарушение правил пользования. Забаненный пользователь может оспорить решение с помощью другого администратора. Если пользователь не оспорил решение или у него это не вышло, через трое суток он банится навсегда.

После бана пользователя все его сделки отменяются, счет замораживается на семь дней, после чего отправляются на развитие компании, а статьи автоматически получают бан.


### 2.5.3. Просмотр чата при жалобе одного из участников

Администратор может получить доступ к чату, если один из участников отправит жалобу.


### 2.5.4. Вынесение решения при спорах в сделке

Администратор может вынести решение, если возник спор между участниками сделки. Его решение можно оспорить с помощью другого администратора в течение трех суток после вынесения решения.


### 2.5.5. Проверка нового животного

Администратор может проверить на соответствие указанные данные и документы животного. После чего дать галочку “проверено”.


# 3. Предлагаемый стек технологий

Бэк будет реализован двумя способами, каждый из которых представлен в виде приложения проекта:

Первый:
* Бэкенд:
  * Фреймворк Django
  * Библиотека Logging для логирования

Второй:
* Бэкенд:
  * Фреймворк Django Rest Framework
  * SQLAlchemy ORM
  * Библиотека Loguru для логирования

Общее:
* Бэкенд:
  * Язык Python
  * Фреймворк Flask для блога
  * Django Channels для чата
  * БД PostgreSQL, Redis
  * SQLAlchemy ORM
  * Celery для почты
* Фронтенд:
  * HTML
  * CSS
  * JavaScript


# 4. Требования к дизайну

Минимальные стили для возможности испытать функционал Бэка.
